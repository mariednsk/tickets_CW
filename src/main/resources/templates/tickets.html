<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–ª–µ—Ç–∞–º–∏ ‚Äî –°–ø—Ä–∞–≤–æ—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–∞—Ç—Ä–∞</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/5/w3.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inconsolata">
    <style>
        body, html {
            height: 100%;
            margin: 0;
            font-family: 'Arial Black', sans-serif;
            background-color: #f5f5f5;
            color: #321b0c;
        }

        /* –®–∞–ø–∫–∞ –∫–∞–∫ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π */
        .w3-top .w3-button { font-weight: bold; }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .container {
            max-width: 1200px;
            margin: 120px auto 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5rem;
            color: #321b0c;
        }

        /* –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ */
        .user-greeting {
            text-align: center;
            font-size: 1rem;
            margin-bottom: 20px;
        }

        /* –¢–∞–±–ª–∏—Ü–∞ –±–∏–ª–µ—Ç–æ–≤ */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
        }

        th {
            background-color: #321b0c;
            color: white;
            font-weight: bold;
        }

        tr:nth-child(even) { background-color: #fdfdfd; }
        tr:hover { background-color: #f0e8df; }

        /* –ö–Ω–æ–ø–∫–∏ */
        .button, .add-btn, .edit-btn, .delete-btn {
            background-color: #321b0c;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
        }

        .button:hover, .add-btn:hover, .edit-btn:hover, .delete-btn:hover {
            background-color: #4b3224;
        }

        /* –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –±–∏–ª–µ—Ç–æ–≤ */
        .add-form {
            margin-bottom: 30px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .add-form input {
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #321b0c;
            min-width: 200px;
        }

    </style>
</head>
<body>

<!-- –®–∞–ø–∫–∞ -->
<div class="w3-top">
    <div class="w3-row w3-padding w3-black">
        <div class="w3-col s3">
            <a th:href="@{/}" class="w3-button w3-block w3-black">–ì–ª–∞–≤–Ω–∞—è</a>
        </div>
        <div class="w3-col s3" sec:authorize="isAuthenticated()">
            <form th:action="@{/logout}" method="post">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                <button class="w3-button w3-block w3-black" type="submit">–í—ã–π—Ç–∏</button>
            </form>
        </div>
    </div>
</div>

<div class="container">

    <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–ª–µ—Ç–∞–º–∏</h1>

    <div class="user-greeting" sec:authorize="isAuthenticated()">
        –ü—Ä–∏–≤–µ—Ç, <b sec:authentication="name"></b>
    </div>

    <form th:action="@{/tickets/add}" th:object="${ticket}" method="post" class="add-form" sec:authorize="hasRole('ADMIN')">
        <input type="text" th:field="*{eventName}" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è" required>
        <input type="text" th:field="*{buyerName}" placeholder="–ò–º—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è" required>
        <input type="text" th:field="*{seatNumber}" placeholder="–ù–æ–º–µ—Ä –º–µ—Å—Ç–∞" required>
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
        <button type="submit" class="add-btn">–î–æ–±–∞–≤–∏—Ç—å –±–∏–ª–µ—Ç</button>
    </form>

    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>–°–æ–±—ã—Ç–∏–µ</th>
            <th>–ü–æ–∫—É–ø–∞—Ç–µ–ª—å</th>
            <th>–ú–µ—Å—Ç–æ</th>
            <th sec:authorize="hasRole('ADMIN')">–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="ticket : ${tickets}">
            <td th:text="${ticket.id}"></td>
            <td th:text="${ticket.eventName}"></td>
            <td th:text="${ticket.buyerName}"></td>
            <td th:text="${ticket.seatNumber}"></td>
            <td sec:authorize="hasRole('ADMIN')">
                <a th:href="@{'/tickets/edit/' + ${ticket.id}}" class="edit-btn">‚úèÔ∏è</a>
                <form th:action="@{'/tickets/delete/' + ${ticket.id}}" method="post" style="display:inline;">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                    <button type="submit" class="delete-btn" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –±–∏–ª–µ—Ç?')">üóëÔ∏è</button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>

</div>

</body>
</html>
